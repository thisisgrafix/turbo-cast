<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stream Scanner Feed</title>
    <script src="https://www.gstatic.com/cast/sdk/libs/sender/3.0/cast_framework.js"></script>
    <script>
        function loadCastSDK() {
            const script = document.createElement('script');
            script.src = 'https://www.gstatic.com/cast/sdk/libs/sender/3.0/cast_framework.js';
            script.onload = function () {
                console.log("Cast SDK Loaded");
                initializeCastSDK();
            };
            script.onerror = function () {
                console.error("Failed to load Cast SDK.");
            };
            document.head.appendChild(script);
        }

        function initializeCastSDK() {
            if (typeof chrome !== 'undefined' && typeof chrome.cast !== 'undefined') {
                console.log("Cast SDK is available.");
                const castContext = cast.framework.CastContext.getInstance();
                castContext.setOptions({
                    receiverApplicationId: chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,
                    autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED
                });

                const castButton = document.getElementById("castButton");
                castButton.addEventListener("click", () => {
                    console.log("Requesting session...");
                    castContext.requestSession().then(
                        (session) => {
                            console.log("Session successfully started:", session);
                        },
                        (error) => {
                            console.error("Error requesting session:", error);
                        }
                    );
                });
            } else {
                console.error("Cast SDK is not available.");
            }
        }

        window.onload = function() {
            console.log("Attempting to load Cast SDK...");
            loadCastSDK();
        };
    </script>
</head>
<body>
    <h1>Broadcastify Scanner Feeds</h1>
    <button id="castButton">Cast to Google Home</button>
    <h2>Available Feeds</h2>
    <ul>
        <li><button onclick="castAudio('https://broadcastify.cdnstream1.com/12345')">Feed 1</button></li>
        <li><button onclick="castAudio('https://broadcastify.cdnstream1.com/67890')">Feed 2</button></li>
    </ul>
</body>
</html>
